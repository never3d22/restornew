# RestorNew ‚Äî –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –æ–Ω–ª–∞–π–Ω-–∑–∞–∫–∞–∑–∞ –µ–¥—ã

–ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—á–∏–π –ø—Ä–æ—Ç–æ—Ç–∏–ø –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –º–µ–Ω—é, –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤ –∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞. –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç API –Ω–∞ Hono/tRPC + Drizzle/MySQL –∏ –º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ Expo/React Native —Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º —á–µ—Ä–µ–∑ Zustand –∏ React Query.

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–º–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è)
- [–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏](#–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)
- [–ß–µ–∫-–ª–∏—Å—Ç –±—ã—Å—Ç—Ä–æ–≥–æ –∑–∞–ø—É—Å–∫–∞](#—á–µ–∫-–ª–∏—Å—Ç-–±—ã—Å—Ç—Ä–æ–≥–æ-–∑–∞–ø—É—Å–∫–∞)
- [–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ —Å –Ω—É–ª—è (Node.js + MySQL)](#–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-—Å–µ—Ä–≤–µ—Ä–∞-—Å-–Ω—É–ª—è-nodejs--mysql)
- [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ backend](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-backend)
- [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–º–æ–±–∏–ª—å–Ω–æ–≥–æ-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)
- [–ü—É–±–ª–∏–∫–∞—Ü–∏—è API –≤ –±—Ä–∞—É–∑–µ—Ä–µ (https://roteelonoogu.beget.app)](#–ø—É–±–ª–∏–∫–∞—Ü–∏—è-api-–≤-–±—Ä–∞—É–∑–µ—Ä–µ-httpsroteelonoogu-beget-app)
- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Å—Ü–µ–Ω–∞—Ä–∏—è–º](#–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è-–ø–æ-—Å—Ü–µ–Ω–∞—Ä–∏—è–º)
- [–û—Å–Ω–æ–≤–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã tRPC](#–æ—Å–Ω–æ–≤–Ω—ã–µ-—ç–Ω–¥–ø–æ–∏–Ω—Ç—ã-trpc)
- [SMS –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è](#sms-–∏-–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è)
- [–†–∞–∑–≤–∏—Ç–∏–µ](#—Ä–∞–∑–≤–∏—Ç–∏–µ)
- [–õ–∏—Ü–µ–Ω–∑–∏—è](#–ª–∏—Ü–µ–Ω–∑–∏—è)

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```
backend/  ‚Äî Hono + tRPC API, Drizzle ORM, –º–∏–≥—Ä–∞—Ü–∏–∏ –∏ —Å–∏–¥—ã
mobile/   ‚Äî Expo-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (iOS, Android, Web) –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ –∞–¥–º–∏–Ω–æ–≤
```

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –ö–ª–∏–µ–Ω—Ç—Å–∫–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- üìã –ü—Ä–æ—Å–º–æ—Ç—Ä –º–µ–Ω—é –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º.
- üõí –ö–æ—Ä–∑–∏–Ω–∞ —Å –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–∑–∏—Ü–∏–π –∏ –ø–æ–¥—Å—á–µ—Ç–æ–º —Å—É–º–º—ã.
- üì¶ –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤ –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–∏.
- üè† –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞–º–∏ –¥–æ—Å—Ç–∞–≤–∫–∏.
- üîê –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ SMS-–∫–æ–¥—É (—Ç–µ—Å—Ç–æ–≤—ã–π –∫–æ–¥ 1234).

### –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ
- üìö –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏ –±–ª—é–¥ —á–µ—Ä–µ–∑ tRPC-–º–µ—Ç–æ–¥—ã.
- üì¶ –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∑–∞–∫–∞–∑–æ–≤ —Å —Å–æ—Å—Ç–∞–≤–æ–º –∏ —Å—É–º–º–æ–π.
- üîÅ –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ –∑–∞–∫–∞–∑–æ–≤ (pending ‚Üí confirmed/delivered/cancelled).
- üîë –î–æ—Å—Ç—É–ø –∑–∞—â–∏—â–µ–Ω –∑–∞–≥–æ–ª–æ–≤–∫–æ–º `x-admin-secret` (—Å–º. –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è).

## –ß–µ–∫-–ª–∏—Å—Ç –±—ã—Å—Ç—Ä–æ–≥–æ –∑–∞–ø—É—Å–∫–∞

1. **–ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:** `git clone ... && cd restornew`.
2. **–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å MySQL:** —Å–æ–∑–¥–∞—Ç—å –±–∞–∑—É `restornew_app` –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `restornew_app` —Å –ø–∞—Ä–æ–ª–µ–º `i*2ubUF7LOaG` (—á–µ—Ä–µ–∑ Docker –∏–ª–∏ —Å–∏—Å—Ç–µ–º–Ω—ã–π MySQL).
3. **–ó–∞–ø–æ–ª–Ω–∏—Ç—å `.env` –≤ `backend/` –∏ `mobile/`.**
4. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** `npm install` –≤ –æ–±–æ–∏—Ö –ø–∞–∫–µ—Ç–∞—Ö.
5. **–ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –∏ —Å–∏–¥—ã:** `npm run db:push && npm run db:seed`.
6. **–ó–∞–ø—É—Å—Ç–∏—Ç—å API:** `npm run dev`.
7. **–ó–∞–ø—É—Å—Ç–∏—Ç—å Expo:** `npm run start` –∏ –æ—Ç—Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å QR-–∫–æ–¥ –≤ Expo Go.

–ü–æ–¥—Ä–æ–±–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —Å –∫–æ–º–∞–Ω–¥–∞–º–∏ ‚Äî –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Ä–∞–∑–¥–µ–ª–∞—Ö –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏. –ï—Å–ª–∏ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É —á–µ—Ä–µ–∑ PuTTY –Ω–∞ Windows, –≤–æ—Å–ø–æ–ª—å–∑—É–π—Ç–µ—Å—å –æ—Ç–¥–µ–ª—å–Ω—ã–º –≥–∏–¥–æ–º [docs/putty-ssh.md](docs/putty-ssh.md).

## –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ —Å –Ω—É–ª—è (Node.js + MySQL)

> –í—ã–ø–æ–ª–Ω—è–π—Ç–µ —à–∞–≥–∏ –ø–æ –ø–æ—Ä—è–¥–∫—É –Ω–∞ –Ω–æ–≤–æ–º —Å–µ—Ä–≤–µ—Ä–µ Ubuntu 22.04+, –≥–¥–µ —É–∂–µ –µ—Å—Ç—å Node.js (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç beget.com). –í—Å–µ –∫–æ–º–∞–Ω–¥—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `root`. –ï—Å–ª–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç–µ –∏–∑-–ø–æ–¥ –¥—Ä—É–≥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –¥–æ–±–∞–≤—å—Ç–µ `sudo`.

1. **–û–±–Ω–æ–≤–∏—Ç–µ –ø–∞–∫–µ—Ç—ã –∏ –ø–æ—Å—Ç–∞–≤—å—Ç–µ MySQL Server:**
   ```bash
   apt update
   apt install mysql-server -y
   ```
   –°—Ç–∞—Ç—É—Å —Å–ª—É–∂–±—ã: `systemctl status mysql`. –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å: `systemctl restart mysql`.
2. **(–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ó–∞–ø—É—Å—Ç–∏—Ç–µ –º–∞—Å—Ç–µ—Ä –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:**
   ```bash
   mysql_secure_installation
   ```
   –ú–æ–∂–Ω–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å, –µ—Å–ª–∏ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –≤—Ä—É—á–Ω—É—é –∑–∞–¥–∞—Ç—å –ø–∞—Ä–æ–ª–∏.
3. **–°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**
   ```bash
   mysql
   ```
   –í –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–π –∫–æ–Ω—Å–æ–ª–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
   ```sql
   CREATE DATABASE IF NOT EXISTS restornew_app CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
   CREATE USER IF NOT EXISTS 'restornew_app'@'localhost' IDENTIFIED BY 'i*2ubUF7LOaG';
   GRANT ALL PRIVILEGES ON restornew_app.* TO 'restornew_app'@'localhost';
   FLUSH PRIVILEGES;
   ```
   –ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `i*2ubUF7LOaG`, —á—Ç–æ–±—ã —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π –ø—Ä–æ–µ–∫—Ç–∞. –í—ã–π–¥–∏—Ç–µ –∫–æ–º–∞–Ω–¥–æ–π `exit;`.
4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—Ö–æ–¥ –æ—Ç –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**
   ```bash
   mysql -u restornew_app -p'i*2ubUF7LOaG' -e "SHOW DATABASES;"
   ```
   –ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ `restornew_app` ‚Äî –¥–æ—Å—Ç—É–ø –Ω–∞—Å—Ç—Ä–æ–µ–Ω. –ü—Ä–∏ –æ—à–∏–±–∫–µ `Access denied` –ø–µ—Ä–µ–ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∞—Ä–æ–ª—å –∏ —Ö–æ—Å—Ç –≤ `CREATE USER`.
5. **(–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –†–∞–∑—Ä–µ—à–∏—Ç–µ root-–≤—Ö–æ–¥ –ø–æ –ø–∞—Ä–æ–ª—é:**
   ```sql
   ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY 'your-strong-password';
   ```
   –≠—Ç–æ—Ç —à–∞–≥ –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è, –µ—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –≤–Ω–µ—à–Ω–∏–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏.
6. **–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ ‚Äî Docker Compose:**
   ```bash
   docker compose up -d
   ```
   –§–∞–π–ª `docker-compose.yml` –ø–æ–¥–Ω–∏–º–µ—Ç MySQL 8.0 —Å —Ç–µ–º–∏ –∂–µ –±–∞–∑–æ–π –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º (`restornew_app` / `i*2ubUF7LOaG`). –ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø –∫–æ–º–∞–Ω–¥–æ–π `mysql -h 127.0.0.1 -u restornew_app -p'i*2ubUF7LOaG' -e "SHOW DATABASES;"`.

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ backend

> –†–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–∞–ª–µ–µ ‚Äî `/var/www/html/backend` (–¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞) –∏–ª–∏ `backend/` (–¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã).

1. **–°–æ–∑–¥–∞–π—Ç–µ `.env` –∏–∑ —à–∞–±–ª–æ–Ω–∞:**
   ```bash
   cd backend
   cp .env.example .env
   ```
   –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª (`nano .env`) –∏ –∑–∞–¥–∞–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
   ```env
   DATABASE_URL=mysql://restornew_app:i*2ubUF7LOaG@127.0.0.1:3306/restornew_app
   ADMIN_SECRET=super-secret
   PORT=3000
   ```
   - `DATABASE_URL` ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–µ–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏–Ω, –ø–∞—Ä–æ–ª—å –∏ —Ö–æ—Å—Ç.
   - `ADMIN_SECRET` ‚Äî –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–∞—è —Å—Ç—Ä–æ–∫–∞, –∫–æ—Ç–æ—Ä–æ–π –±—É–¥—É—Ç –ø–æ–¥–ø–∏—Å—ã–≤–∞—Ç—å—Å—è –∞–¥–º–∏–Ω-–∑–∞–ø—Ä–æ—Å—ã (–∑–∞–≥–æ–ª–æ–≤–æ–∫ `x-admin-secret`). –°–æ–æ–±—â–∏—Ç–µ –µ—ë —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º ‚Äî –æ–Ω–∏ –≤–≤–æ–¥—è—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –≤—Ä—É—á–Ω—É—é –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏.
   - `PORT` ‚Äî –ø–æ—Ä—Ç, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å API.
2. **(–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –£–∫–∞–∂–∏—Ç–µ –∑–µ—Ä–∫–∞–ª–æ npm, –µ—Å–ª–∏ –æ—Å–Ω–æ–≤–Ω–æ–π registry –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω:**
   ```bash
   echo "registry=https://registry.npmmirror.com" > ~/.npmrc
   ```
   –£–¥–∞–ª–∏—Ç–µ —Ñ–∞–π–ª, –∫–æ–≥–¥–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –æ—Ç–ø–∞–¥—ë—Ç.
3. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ —Å–æ–±–µ—Ä–∏—Ç–µ —Å—Ö–µ–º—É:**
   ```bash
   npm install
   npm run db:push
   npm run db:seed
   ```
   - –ï—Å–ª–∏ `npm install` –∑–∞–≤–µ—Ä—à–∏–ª—Å—è –æ—à–∏–±–∫–æ–π –∏–∑-–∑–∞ –ø–∞–∫–µ—Ç–∞, –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É –∏–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ –∑–µ—Ä–∫–∞–ª–æ.
   - –ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ `Access denied for user`, –≤–µ—Ä–Ω–∏—Ç–µ—Å—å –∫ —à–∞–≥—É —Å MySQL –∏ –ø–µ—Ä–µ–ø—Ä–æ–≤–µ—Ä—å—Ç–µ `DATABASE_URL`.
4. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:**
   ```bash
   npm run dev
   # API –¥–æ—Å—Ç—É–ø–Ω–æ –Ω–∞ http://localhost:3000, tRPC –Ω–∞ /trpc
   ```
   –°–µ—Ä–≤–µ—Ä –ª–æ–≥–∏—Ä—É–µ—Ç `API running on http://localhost:3000`. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å ‚Äî `Ctrl+C`.
5. **–°–æ–±–µ—Ä–∏—Ç–µ production-–±–∞–Ω–¥–ª:**
   ```bash
   npm run build
   node dist/index.js
   ```
   –ö–æ–º–∞–Ω–¥–∞ –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ —á–µ—Ä–µ–∑ systemd.

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

> –†–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è ‚Äî `mobile/`.

1. **–°–æ–∑–¥–∞–π—Ç–µ `.env`:**
   ```bash
   cd mobile
   cp .env.example .env
   ```
   –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
   ```env
   EXPO_PUBLIC_API_URL=https://roteelonoogu.beget.app/trpc
   ```
   –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–º–µ–Ω–∏—Ç–µ —Ö–æ—Å—Ç –Ω–∞ `http://<IP-—Å–µ—Ä–≤–µ—Ä–∞>:3000/trpc`.
   –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—Å–∫–∏–π —Å–µ–∫—Ä–µ—Ç –≤–≤–æ–¥–∏—Ç—Å—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –Ω–∞ –≤–∫–ª–∞–¥–∫–µ ¬´–ê–¥–º–∏–Ω¬ª (—Å–º. [docs/expo-go.md](docs/expo-go.md)).
2. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** `npm install`.
3. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ Expo:** `npm run start` –∏ —Å–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –≤ –∫–æ–Ω—Å–æ–ª–∏ (—Å–º. [docs/expo-go.md](docs/expo-go.md) –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ–≥–æ –≥–∞–π–¥–∞ –ø–æ Expo Go –∏ –≤–µ–±-–≤–µ—Ä—Å–∏–∏).

## –ü—É–±–ª–∏–∫–∞—Ü–∏—è API –≤ –±—Ä–∞—É–∑–µ—Ä–µ (`https://roteelonoogu.beget.app`)

–°–ª–µ–¥—É—é—â–∏–π —á–µ–∫-–ª–∏—Å—Ç –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä beget.com —Å –ø—É—Ç—è–º–∏ `/var/www/html/backend`. –í—ã–ø–æ–ª–Ω—è–π—Ç–µ —à–∞–≥–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ.

1. **–ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ backend:**
   ```bash
   cd /var/www/html/backend
   cp .env.example .env       # –µ—Å–ª–∏ —Ñ–∞–π–ª–∞ –µ—â—ë –Ω–µ—Ç
   nano .env                  # –ø—Ä–æ–ø–∏—à–∏—Ç–µ DATABASE_URL, ADMIN_SECRET, PORT
   npm install
   npm run db:push
   npm run db:seed
   npm run build
   ```
   - –í `DATABASE_URL` —É–∫–∞–∂–∏—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è MySQL (`mysql://restornew_app:i*2ubUF7LOaG@127.0.0.1:3306/restornew_app`).
   - –ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö npm –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∑–µ—Ä–∫–∞–ª–æ (`/var/www/html/.npmrc`) –∏ –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É.
   - –ï—Å–ª–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ –ø–∞–¥–∞—é—Ç —Å `Access denied`, –≤–µ—Ä–Ω–∏—Ç–µ—Å—å –∫ —Ä–∞–∑–¥–µ–ª—É MySQL, –æ–±–Ω–æ–≤–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø–∞—Ä–æ–ª—å.
2. **–°–æ–∑–¥–∞–π—Ç–µ systemd-—Å–µ—Ä–≤–∏—Å, —á—Ç–æ–±—ã API —Ä–∞–±–æ—Ç–∞–ª–æ –≤ —Ñ–æ–Ω–µ:**
   ```bash
   sudo tee /etc/systemd/system/restornew.service >/dev/null <<'EOF'
   [Unit]
   Description=RestorNew API
   After=network.target

   [Service]
   Type=simple
   WorkingDirectory=/var/www/html/backend
   ExecStart=/usr/bin/node --enable-source-maps /var/www/html/backend/dist/index.js
   Restart=always
   RestartSec=5
   EnvironmentFile=/var/www/html/backend/.env

   [Install]
   WantedBy=multi-user.target
   EOF

   sudo systemctl daemon-reload
   sudo systemctl enable --now restornew.service
   sudo systemctl status restornew.service
   ```
   - –í —Å—Ç–∞—Ç—É—Å–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å `Active: active (running)`.
   - –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤: `journalctl -u restornew.service -f`.
   - –ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º `npm run dev` –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–µ—Ä–≤–∏—Å: `sudo systemctl stop restornew.service`, –∏–Ω–∞—á–µ –ø–æ—Ä—Ç 3000 –±—É–¥–µ—Ç –∑–∞–Ω—è—Ç (`EADDRINUSE`).
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ API –Ω–∞–ø—Ä—è–º—É—é:**
   ```bash
   curl http://127.0.0.1:3000/
   curl http://127.0.0.1:3000/health
   ```
   –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ—Ç–≤–µ—Ç—ã –ø—Ä–∏—Ö–æ–¥—è—Ç –±–µ–∑ –æ—à–∏–±–æ–∫.
4. **–û—Ç–∫—Ä–æ–π—Ç–µ –ø–æ—Ä—Ç—ã –≤ UFW (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω):**
   ```bash
   sudo ufw allow 80
   sudo ufw allow 443
   sudo ufw allow 3000   # —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω—É–∂–µ–Ω –ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –±–µ–∑ –ø—Ä–æ–∫—Å–∏
   sudo ufw status
   ```
5. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ Nginx –∫–∞–∫ –æ–±—Ä–∞—Ç–Ω—ã–π –ø—Ä–æ–∫—Å–∏ –¥–ª—è –¥–æ–º–µ–Ω–∞:**
   ```bash
   sudo apt update
   sudo apt install nginx -y

   sudo tee /etc/nginx/sites-available/roteelonoogu.beget.app >/dev/null <<'EOF'
   server {
     listen 80;
     server_name roteelonoogu.beget.app;

     location / {
       proxy_pass http://127.0.0.1:3000;
       proxy_http_version 1.1;
       proxy_set_header Host $host;
       proxy_set_header X-Real-IP $remote_addr;
       proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
       proxy_set_header X-Forwarded-Proto $scheme;
     }
   }
   EOF

   sudo ln -sf /etc/nginx/sites-available/roteelonoogu.beget.app /etc/nginx/sites-enabled/roteelonoogu.beget.app
   sudo nginx -t
   sudo systemctl reload nginx
   ```
   - –ï—Å–ª–∏ `nginx -t` —Å–æ–æ–±—â–∞–µ—Ç `unknown directive "application/javascript"`, –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ñ–∞–π–ª –º–∞–ø–ø–∏–Ω–≥–∞ MIME: `sudo cp /usr/share/nginx/mime.types /etc/nginx/mime.types` –∏ –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ —Ç–µ—Å—Ç.
6. **(–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ü–æ–¥–∫–ª—é—á–∏—Ç–µ HTTPS —á–µ—Ä–µ–∑ Let‚Äôs Encrypt:**
   ```bash
   sudo apt install certbot python3-certbot-nginx -y
   sudo certbot --nginx -d roteelonoogu.beget.app
   ```
   Certbot –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–∏—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤.
7. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–∑ –±—Ä–∞—É–∑–µ—Ä–∞:**
   - `https://roteelonoogu.beget.app` ‚Äî HTML-–∑–∞–≥–ª—É—à–∫–∞ API.
   - `https://roteelonoogu.beget.app/health` ‚Äî —Ç–µ–∫—Å—Ç `healthy`.
   - `https://roteelonoogu.beget.app/trpc` ‚Äî tRPC-—ç–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤.
8. **–û–±–Ω–æ–≤–∏—Ç–µ –º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:** –ø–æ–º–µ–Ω—è–π—Ç–µ `EXPO_PUBLIC_API_URL` –≤ `mobile/.env` –Ω–∞ HTTPS-–∞–¥—Ä–µ—Å –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Expo (`npm run start`).

–ü–æ–¥—Ä–æ–±–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏ –ø—Ä–∏–≤–µ–¥—ë–Ω –≤ [docs/browser-access.md](docs/browser-access.md).

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Å—Ü–µ–Ω–∞—Ä–∏—è–º

- [docs/browser-access.md](docs/browser-access.md) ‚Äî —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –≤—ã–≤–æ–¥—É backend –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ Nginx/SSL.
- [docs/expo-go.md](docs/expo-go.md) ‚Äî –ø–æ—à–∞–≥–æ–≤–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Expo Go, –∑–∞–ø—É—Å–∫ –≤–µ–±-–≤–µ—Ä—Å–∏–∏ –∏ —Å–æ–≤–µ—Ç—ã –ø–æ –æ—Ç–ª–∞–¥–∫–µ.
- [docs/putty-ssh.md](docs/putty-ssh.md) ‚Äî –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É —á–µ—Ä–µ–∑ PuTTY, –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥ –∏ –ø–µ—Ä–µ–¥–∞—á–∞ —Ñ–∞–π–ª–æ–≤ –ø–æ SFTP.

## –û—Å–Ω–æ–≤–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã tRPC

| –ü—Ä–æ—Ü–µ–¥—É—Ä–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|----------|
| `menu.list` | –°–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Å –±–ª—é–¥–∞–º–∏. |
| `orders.create` | –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞. |
| `orders.history` | –ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤ –∫–ª–∏–µ–Ω—Ç–∞. |
| `addresses.*` | –ü–æ–ª—É—á–µ–Ω–∏–µ –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –∞–¥—Ä–µ—Å–æ–≤ –¥–æ—Å—Ç–∞–≤–∫–∏. |
| `auth.requestCode` | –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ SMS-–∫–æ–¥–∞ (–ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å). |
| `auth.verifyCode` | –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∫–æ–¥–∞, —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. |
| `admin.*` | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏, –±–ª—é–¥–∞–º–∏ –∏ —Å—Ç–∞—Ç—É—Å–∞–º–∏ –∑–∞–∫–∞–∑–æ–≤ (—á–µ—Ä–µ–∑ `x-admin-secret`). |

## SMS –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å SMS.ru –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –∑–∞–≥–ª—É—à–∫–æ–π: –∫–æ–¥ –≤—Å–µ–≥–¥–∞ `1234`, –∞ –æ—Ç–ø—Ä–∞–≤–∫–∞ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å —Å–µ—Ä–≤–µ—Ä–∞. –õ–æ–≥–∏–∫—É –º–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å, –∑–∞–º–µ–Ω–∏–≤ `auth.requestCode` –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π –≤—ã–∑–æ–≤ API SMS.ru.

## –†–∞–∑–≤–∏—Ç–∏–µ

- üí≥ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–Ω–æ–≥–æ —à–ª—é–∑–∞ –∏ —Å—Ç–∞—Ç—É—Å–æ–≤ –æ–ø–ª–∞—Ç—ã.
- üîî Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ –∫—É—Ä—å–µ—Ä–æ–≤.
- üìà –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (Prometheus, Sentry).
- üß™ –ê–≤—Ç–æ—Ç–µ—Å—Ç—ã (unit + e2e) –∏ CI/CD –Ω–∞ beget –∏–ª–∏ GitHub Actions.

## –õ–∏—Ü–µ–Ω–∑–∏—è

–ü—Ä–æ–µ–∫—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π MIT. –í—ã –º–æ–∂–µ—Ç–µ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ –ø–æ–¥ –Ω—É–∂–¥—ã —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞, —Ä–∞—Å—à–∏—Ä—è—Ç—å —Å—Ö–µ–º—É –¥–∞–Ω–Ω—ã—Ö –∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–æ—Ä–æ–Ω–Ω–∏–µ —Å–µ—Ä–≤–∏—Å—ã.
